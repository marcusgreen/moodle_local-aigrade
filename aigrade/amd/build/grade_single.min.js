/**
 * AMD module for AI Grade single submission button
 *
 * @module     local_aigrade/grade_single
 * @copyright  2025 Brian A. Pool, National Trail Local Schools
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_aigrade/grade_single",["jquery"],(function($){return{init:function(buttonUrl,buttonText,sesskey){var checkCount=0,insertButton=function(){if(checkCount++,$(".aigrade-single-button").length>0)return!0;if(!($('div[id*="fitem_id_assignfeedbackcomments"]').length>0)&&checkCount<20)return!1;var button=$("<button>").attr("type","button").addClass("btn btn-primary aigrade-single-button").text(buttonText).on("click",(function(){var btn=$(this),originalText=btn.text();btn.prop("disabled",!0).text("Grading..."),$.ajax({url:buttonUrl+"&action=grade&sesskey="+sesskey,method:"POST",dataType:"json",success:function(response){if(response.success)window.location.reload();else{var errorMsg=response.error||"Unknown error occurred";alert("Error: "+errorMsg),btn.prop("disabled",!1).text(originalText)}},error:function(xhr,status,error){alert("Error communicating with server: "+error),btn.prop("disabled",!1).text(originalText)}})})),container=$("<div>").addClass("local_aigrade-button-container").append(button),inserted=!1,gradeInput=$('input[name*="grade"]'),feedbackSection=$('div[id*="fitem_id_assignfeedbackcomments"]');if(feedbackSection.length&&(feedbackSection.before(container),inserted=!0),!inserted&&gradeInput.length&&(gradeInput.first().closest(".fitem, .form-group").before(container),inserted=!0),!inserted&&$('[data-region="grade-panel"]').length&&($('[data-region="grade-panel"]').prepend(container),inserted=!0),!inserted){var mainContent=$('#region-main-box, #region-main, [role="main"]').first();mainContent.length&&(mainContent.prepend(container),inserted=!0)}return inserted},insertInterval=setInterval((function(){(insertButton()||checkCount>=20)&&clearInterval(insertInterval)}),500);$(window).on("load",insertButton),$(document).ajaxComplete((function(){insertButton()}))}}}));

//# sourceMappingURL=grade_single.min.js.map