/**
 * AMD module for AI Grade bulk grading button
 *
 * @module     local_aigrade/grade_bulk
 * @copyright  2025 Brian A. Pool, National Trail Local Schools
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_aigrade/grade_bulk",["jquery","core/ajax","core/notification","core/str"],(function($,Ajax,Notification,Str){return{init:function(buttonUrl,buttonText,sesskey){$(document).ready((function(){if(!($(".aigrade-button-injected").length>0)){var button=$("<button>").attr("type","button").addClass("btn btn-primary aigrade-button-injected").text(buttonText).on("click",(function(){var btn=$(this),originalText=btn.text();Str.get_string("confirm_bulk_grade","local_aigrade").done((function(confirmMsg){confirm(confirmMsg)&&(btn.prop("disabled",!0).text("Grading all submissions..."),$.ajax({url:buttonUrl+"&action=grade&sesskey="+sesskey,method:"POST",dataType:"json",success:function(response){response.success?(Notification.addNotification({message:"Successfully graded "+response.count+" submission(s).",type:"success"}),window.location.reload()):(Notification.addNotification({message:"Error: "+(response.error||"Unknown error occurred"),type:"error"}),btn.prop("disabled",!1).text(originalText))},error:function(xhr,status,error){Notification.addNotification({message:"Error communicating with server: "+error,type:"error"}),btn.prop("disabled",!1).text(originalText)}}))})).fail((function(){confirm("Grade all ungraded submissions with AI? This may take a few moments.")&&(btn.prop("disabled",!0).text("Grading all submissions..."),$.ajax({url:buttonUrl+"&action=grade&sesskey="+sesskey,method:"POST",dataType:"json",success:function(response){response.success?(alert("Successfully graded "+response.count+" submission(s)."),window.location.reload()):(alert("Error: "+(response.error||"Unknown error occurred")),btn.prop("disabled",!1).text(originalText))},error:function(xhr,status,error){alert("Error communicating with server: "+error),btn.prop("disabled",!1).text(originalText)}}))}))}));$(".tertiary-navigation").length?$(".tertiary-navigation").first().prepend($("<div>").css("display","inline-block").append(button)):$("#page-header").length?$("#page-header").first().after($("<div>").addClass("alert alert-info").css("margin","15px").append(button)):$("#page-content").prepend($("<div>").addClass("alert alert-info").css("margin","15px").append(button))}}))}}}));

//# sourceMappingURL=grade_bulk.min.js.map